!function(){"use strict";function e(e){e=e||"";var t=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e)),t.appendChild(n)}function t(e,t,n){this.nodeName=e,this.attributes=t,this.children=n}function n(e,t){for(var n in t)ce.call(t,n)&&(e[n]=t[n]);return e}function o(e){var t={};for(var n in e)t[n]=e[n];return t}function i(e,t){return t=t||{},function(n){return ce.call(t,n)?t[n]:t[n]=e(n)}}function r(e,t){for(var n=t.split("."),o=0;o<n.length&&e;o++)e=e[n[o]];return e}function s(e){for(var t=[],n=e.length;n--;)t[n]=e[n];return t}function a(e){var t="";for(var n in e){var o=e[n];de(o)||(t&&(t+=" "),t+=he(n),t+=": ",t+=o,"number"!=typeof o||ae[n]||(t+="px"),t+=";")}return t}function l(e){var t="";for(var n in e)e[n]&&(t&&(t+=" "),t+=n);return t}function u(e,t,n){var o=e[t];o&&!ue(o)&&(e[t]=n(o))}function c(e,t,n){return d(ye,e,t,n)}function d(e,t,n,o,i){return e[t]?e[t](n,o,i):void 0}function p(e,t){do d(e,t);while(e=e._component)}function h(e,n){var o=arguments.length,i=void 0,r=void 0,s=void 0;if(o>2){i=[];for(var a=2;o>a;a++){var l=arguments[a];if(!pe(l)){l.join?r=l:(r=be,r[0]=l);for(var u=0;u<r.length;u++){var d=r[u],p=!(pe(d)||d instanceof t);p&&(d=String(d)),p&&s?i[i.length-1]+=d:pe(d)||i.push(d),s=p}}}}n&&n.children&&delete n.children;var h=new t(e,n||void 0,i||void 0);return c("vnode",h),h}function f(e,t,n){var o=t.split("."),i=o[0],s=o.length;return function(t){var a=this,l=e.state,u=l,c=void 0,d=void 0;if(ue(n)?(c=r(t,n),de(c)&&(a=a._component)&&(c=r(a,n))):c=(a.nodeName+a.type).match(/^input(check|rad)/i)?a.checked:a.value,le(c)&&(c=c.call(a)),s>1){for(d=0;s-1>d;d++)u=u[o[d]]||(u[o[d]]={});u[o[d]]=c,c=l[i]}e.setState(X.defineProperty({},i,c))}}function v(e){1===xe.push(e)&&(ye.debounceRendering||me)(g)}function g(){if(xe.length){var e=xe,t=void 0;for(xe=ke,ke=e;t=e.pop();)t._dirty&&q(t)}}function m(e){var t=e.nodeName;return le(t)&&!(t.prototype&&t.prototype.render)}function y(e,t){return e.nodeName(O(e),t||te)||ne}function b(e){return e[re]||(e[re]={})}function x(e){return e.nodeType}function k(e,t){for(var n=t.length,o=n>2,i=o?document.createDocumentFragment():e,r=0;n>r;r++)i.appendChild(t[r]);o&&e.appendChild(i)}function C(e){var t=e.parentNode;t&&t.removeChild(e)}function S(e,t,n,o){if("type"!==t&&"style"!==t&&t in e)return e[t];var i=e[re];return o!==!1&&i&&ce.call(i,t)?i[t]:"class"===t?e.className:"style"===t?e.style.cssText:n}function w(e,t,n){"class"===t?e.className=n||"":"style"===t?e.style.cssText=n||"":"dangerouslySetInnerHTML"===t?n&&n.__html&&(e.innerHTML=n.__html):"key"===t||t in e&&"type"!==t?(e[t]=n,pe(n)&&e.removeAttribute(t)):F(e,t,n),b(e)[t]=n}function F(e,t,n){if("on"===t.substring(0,2)){var o=Ce(t),i=e._listeners||(e._listeners={}),r=i[o]?n?null:"remove":"add";return r&&e[r+"EventListener"](o,_),void(i[o]=n)}var s="undefined"==typeof n?"undefined":X["typeof"](n);pe(n)?e.removeAttribute(t):"function"!==s&&"object"!==s&&e.setAttribute(t,n)}function _(e){var t=this._listeners[Ce(e.type)];return t?t.call(this,c("event",e)||e):void 0}function A(e){return e[re]||R(e)||te}function R(e){var t=e.attributes;return t&&t.getNamedItem?M(t):t}function M(e){for(var t=void 0,n=e.length;n--;){var o=e[n];t||(t={}),t[o.name]=o.value}return t}function N(e,t){if(m(t))return!0;var n=t.nodeName;return le(n)?e._componentConstructor===n:3===x(e)?ue(t):fe(e.nodeName)===n}function O(e){var t=o(e.attributes),n=e.children;n&&(t.children=n);var i=e.nodeName.defaultProps;if(i)for(var r in i)!ce.call(i,r)||r in t||(t[r]=i[r]);return t}function B(e){z(e);var t=we(e.nodeName),n=Se[t];n?n.push(e):Se[t]=[e]}function T(e){var t=we(e),n=Se[t],o=n&&n.pop()||document.createElement(e);return b(o),o}function z(e){C(e),3!==x(e)&&(e[re]||(e[re]=R(e)),e._component=e._componentConstructor=null)}function P(e,t,n){for(var o=t.attributes;m(t);)t=y(t,n);if(le(t.nodeName))return I(e,t,n);if(ue(t)){if(e){var i=x(e);if(3===i)return e[ie]=t,e;1===i&&B(e)}return document.createTextNode(t)}var r=e,a=t.nodeName||se;return e?fe(e.nodeName)!==a&&(r=T(a),k(r,s(e.childNodes)),j(e)):r=T(a),D(r,t,n),H(r,t),o&&o.ref&&(r[re].ref=o.ref)(r),r}function D(e,t,n){var o=void 0,i=void 0,r=0,s=e.childNodes.length,a=0;if(s){o=[];for(var l=0;s>l;l++){var u=e.childNodes[l],c=u._component?u._component.__key:S(u,"key");de(c)?o[a++]=u:(i||(i={}),i[c]=u,r++)}}var d=t.children,h=d&&d.length,f=0;if(h)for(var v=0;h>v;v++){var g=d[v],m=void 0;if(r){var y=g.attributes,b=y&&y.key;!de(b)&&ce.call(i,b)&&(m=i[b],i[b]=null,r--)}if(!m&&a>f)for(var x=f;a>x;x++){var k=o[x];if(k&&N(k,g)){m=k,o[x]=null,x===a-1&&a--,x===f&&f++;break}}if(m=P(m,g,n),e.childNodes[v]!==m){var C=m.parentNode!==e&&m._component,w=e.childNodes[v+1];C&&p(C,"componentWillMount"),w?e.insertBefore(m,w):e.appendChild(m),C&&p(C,"componentDidMount")}}if(r)for(var F in i)ce.call(i,F)&&i[F]&&(o[f=a++]=i[F]);a>f&&L(o)}function L(e,t){for(var n=e.length;n--;){var o=e[n];o&&j(o,t)}}function j(e,t){var n=e[re];n&&d(n,"ref",null);var o=e._component;if(o)K(o,!t);else{if(!t){if(1!==x(e))return void C(e);B(e)}var i=e.childNodes;i&&i.length&&L(i,t)}}function H(e,t){var n=A(e)||te,o=t.attributes||te,i=void 0,r=void 0;for(i in n)de(o[i])&&w(e,i,null);if(o!==te)for(i in o)ce.call(o,i)&&(r=o[i],de(r)||r==S(e,i)||w(e,i,r))}function U(e){var t=e.constructor.name,n=Fe[t];n?n.push(e):Fe[t]=[e]}function V(e,t,n){for(var o=Fe[e.name],i=o&&o.length,r=void 0,s=0;i>s;s++)if(r=o[s],r.constructor===e){o.splice(s,1);var a=new e(t,n);return a.nextBase=r.base,a}return new e(t,n)}function E(e){e._dirty||(e._dirty=!0,v(e))}function W(e,t,n,o){var i=e._disableRendering;e.__ref=t.ref,e.__key=t.key,delete t.ref,delete t.key,e._disableRendering=!0,o&&(e.prevContext||(e.prevContext=e.context),e.context=o),e.base&&d(e,"componentWillReceiveProps",t,e.context),e.prevProps||(e.prevProps=e.props),e.props=t,e._disableRendering=i,n&&n.render===!1||(n&&n.renderSync||ye.syncComponentUpdates!==!1?q(e):E(e)),d(e,"__ref",e)}function q(e,t){if(!e._disableRendering){var n=void 0,o=void 0,i=e.props,r=e.state,s=e.context,a=e.prevProps||i,l=e.prevState||r,u=e.prevContext||s,c=e.base,h=c||e.nextBase;if(c&&(e.props=a,e.state=l,e.context=u,d(e,"shouldComponentUpdate",i,r,s)===!1?n=!0:d(e,"componentWillUpdate",i,r,s),e.props=i,e.state=r,e.context=s),e.prevProps=e.prevState=e.prevContext=e.nextBase=null,e._dirty=!1,!n){o=d(e,"render",i,r,s);var f=o&&o.nodeName,v=e.getChildContext?e.getChildContext():s,g=void 0,m=void 0;if(le(f)&&f.prototype.render){var y=e._component;y&&y.constructor!==f&&(g=y,y=null);var b=O(o);y?W(y,b,J,v):(y=V(f,b,v),y._parentComponent=e,e._component=y,c&&p(y,"componentWillMount"),W(y,b,$,v),q(y,ee),c&&p(y,"componentDidMount")),m=y.base}else{var x=h;g=e._component,g&&(x=e._component=null),(h||t&&t.build)&&(m=P(x,o||ne,v))}if(h&&m!==h){var k=h.parentNode;k&&m!==k&&k.replaceChild(m,h)}if(g&&K(g,!0),e.base=m,m){for(var C=e,S=e;S=S._parentComponent;)C=S;m._component=C,m._componentConstructor=C.constructor}c&&d(e,"componentDidUpdate",a,l,u)}var w=e._renderCallbacks,F=void 0;if(w)for(;F=w.pop();)F.call(e);return o}}function I(e,t,n){for(var o=e&&e._component,i=e,r=o&&e._componentConstructor===t.nodeName;o&&!r&&(o=o._parentComponent);)r=o.constructor===t.nodeName;return r?(W(o,O(t),J,n),e=o.base):(o&&(K(o,!0),e=i=null),e=G(t,e,n),i&&e!==i&&(i._component=null,j(i))),e}function G(e,t,n){var o=O(e),i=V(e.nodeName,o,n);return t&&!i.base&&(i.base=t),W(i,o,$,n),q(i,ee),i.base}function K(e,t){d(e,"__ref",null),d(e,"componentWillUnmount");var n=e._component;n&&(K(n,t),t=!1);var o=e.base;o&&(t!==!1&&C(o),L(o.childNodes,!0)),t&&(e._parentComponent=null,U(e)),d(e,"componentDidUnmount")}function Q(e,t){this._dirty=this._disableRendering=!1,this.prevState=this.prevProps=this.prevContext=this.base=this.nextBase=this._parentComponent=this._component=this.__ref=this.__key=this._linkedStates=this._renderCallbacks=null,this.context=t||{},this.props=e,this.state=d(this,"getInitialState")||{}}function Y(e,t,n){var o=n&&n._component&&n._componentConstructor===e.nodeName,i=P(n,e),r=!o&&i._component;return r&&p(r,"componentWillMount"),i.parentNode!==t&&t.appendChild(i),r&&p(r,"componentDidMount"),i}var Z={settings:{saveDestination:"http://coralasks.theguardian.com/ask/44",showFieldNumbers:!0},page:{id:1,name:"first_page",children:[{type:"separator",component:"Header",props:{text:"An amazing Ask."}},{type:"field",component:"TextField",title:"Please type your e-mail",validationMessage:"Please type a valid e-mail address.",props:{maxLength:100,required:!0,validateAs:"email"}},{type:"field",component:"TextField",title:"Are you here just to troll or annoy people?",props:{maxLength:100,required:!0}},{type:"field",component:"TextField",title:"Would you reveal other person's personal data?",props:{maxLength:100,required:!0}},{type:"field",component:"TextArea",title:"Please paste a comment from you on another site",props:{maxLength:400}},{type:"field",component:"ImageOptions",title:"Pick your favorite pic - pun intended",props:{steps:5}},{type:"field",component:"Rating",title:"Rate yourself as a commenteer",props:{steps:5}},{type:"field",component:"Audio",title:"Explain why should we let yourself comment on our site",props:{steps:5}},{type:"field",component:"Drawer",title:"Draw something for us",props:{}}]}},X={};X["typeof"]="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},X.classCallCheck=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},X.createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),X.defineProperty=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},X["extends"]=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},X.inherits=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},X.possibleConstructorReturn=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t};var $={render:!1},J={renderSync:!0},ee={build:!0},te={},ne="",oe="undefined"!=typeof document,ie=!oe||"textContent"in document?"textContent":"nodeValue",re="undefined"!=typeof Symbol?Symbol["for"]("preactattr"):"__preactattr_",se="undefined",ae={boxFlex:1,boxFlexGroup:1,columnCount:1,fillOpacity:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,fontWeight:1,lineClamp:1,lineHeight:1,opacity:1,order:1,orphans:1,strokeOpacity:1,widows:1,zIndex:1,zoom:1},le=function(e){return"function"==typeof e},ue=function(e){return"string"==typeof e},ce={}.hasOwnProperty,de=function(e){return null==e},pe=function(e){return e===!1||null==e},he=i(function(e){return e.replace(/([A-Z])/g,"-$1").toLowerCase()}),fe=i(function(e){return e.toLowerCase()}),ve=void 0;try{ve=new MessageChannel}catch(ge){}var me=ve?function(e){ve.port1.onmessage=e,ve.port2.postMessage("")}:setTimeout,ye={vnode:function(e){var t=e.attributes;if(t&&!le(e.nodeName)){var n=t.className;n&&(t["class"]=n,delete t.className),t["class"]&&u(t,"class",l),t.style&&u(t,"style",a)}}},be=[],xe=[],ke=[],Ce=i(function(e){return e.replace(/^on/i,"").toLowerCase()}),Se={},we=i(function(e){return e.toUpperCase()}),Fe={};n(Q.prototype,{linkState:function(e,t){var n=this._linkedStates||(this._linkedStates={}),o=e+"|"+(t||"");return n[o]||(n[o]=f(this,e,t))},setState:function(e,t){var i=this.state;this.prevState||(this.prevState=o(i)),n(i,le(e)?e(i,this.props):e),t&&(this._renderCallbacks=this._renderCallbacks||[]).push(t),E(this)},forceUpdate:function(){q(this)},render:function(){return null}});var _e={h:h,Component:Q,render:Y,rerender:g,options:ye,hooks:ye},Ae=(_e.h,_e.Component),Re=function(e){function t(e,n){X.classCallCheck(this,t);var o=X.possibleConstructorReturn(this,Object.getPrototypeOf(t).call(this,e,n));return o.state={value:null,isValid:!1,completed:!1,focused:!1},o}return X.inherits(t,e),X.createClass(t,[{key:"save",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{moveForward:!1}:arguments[0];this.props.onSave({index:this.props.index,value:this.state.value,isValid:this.state.isValid,completed:this.state.completed,validationMessage:this.props.validationMessage||"Please check this field",moveForward:e.moveForward||!1})}}]),t}(Ae),Me=(_e.Component,_e.h),Ne=function(e){function t(e,n){X.classCallCheck(this,t);var o=X.possibleConstructorReturn(this,Object.getPrototypeOf(t).call(this,e,n));return o.state={rating:0,hovering:0,focused:-1,value:0},o}return X.inherits(t,e),X.createClass(t,[{key:"getStyles",value:function(){return X["extends"]({},Oe.base,this.props.isValid?Oe.valid:Oe.error)}},{key:"onBlur",value:function(){this.setState({focused:-1})}},{key:"onFocus",value:function(e,t){this.setState({focused:e}),this.props.onFocus()}},{key:"onHover",value:function(e,t){this.setState({hovering:e}),this.props.onFocus()}},{key:"onClick",value:function(e,t){this.setState({value:e}),this.state.value>0?this.setState({focused:!1,completed:!0,isValid:!0}):this.setState({focused:!1,completed:!1}),this.update()}},{key:"onMouseOut",value:function(){this.setState({hovering:0})}},{key:"getTokenStyle",value:function(e){return X["extends"]({},Oe.token,e==this.state.focused?Oe.focused:{},e<this.state.hovering?Oe.hovering:{},e<this.state.value?Oe.clicked:{})}},{key:"getTokens",value:function(){for(var e=[],t=this.props.steps||5,n=0;t>n;n++)e.push(Me("button",{onBlur:this.onBlur.bind(this),onFocus:this.onFocus.bind(this,n),onMouseOver:this.onHover.bind(this,n+1),onClick:this.onClick.bind(this,n+1),style:this.getTokenStyle(n)},"★"));return e}},{key:"render",value:function(){return Me("div",{style:Oe.base,onMouseOut:this.onMouseOut.bind(this)},this.getTokens().map(function(e){return e}))}}]),t}(Re),Oe={base:{display:"block",color:"#888",width:"90%",outline:"none",border:"none",minHeight:"100px"},token:{fontSize:"50px",cursor:"pointer",color:"#777",lineHeight:"50px",transition:"color .2s",background:"none",border:"none",outline:"none"},hovering:{color:"#1E88E5"},clicked:{color:"#F57C00"},focused:{color:"#FF5722"},focusedTitle:{color:"#009688"}},Be=_e.h,Te=_e.Component,ze=function(e){function t(e,n){X.classCallCheck(this,t);var o=X.possibleConstructorReturn(this,Object.getPrototypeOf(t).call(this,e,n));return o.state={recording:!1,initialized:!1,recorded:!1,recordedAudioURL:""},o}return X.inherits(t,e),X.createClass(t,[{key:"initAudio",value:function(){navigator.getUserMedia||(navigator.getUserMedia=navigator.webkitGetUserMedia||navigator.mozGetUserMedia),navigator.cancelAnimationFrame||(navigator.cancelAnimationFrame=navigator.webkitCancelAnimationFrame||navigator.mozCancelAnimationFrame),navigator.requestAnimationFrame||(navigator.requestAnimationFrame=navigator.webkitRequestAnimationFrame||navigator.mozRequestAnimationFrame),navigator.getUserMedia({audio:{mandatory:{googEchoCancellation:"false",googAutoGainControl:"false",googNoiseSuppression:"false",googHighpassFilter:"false"},optional:[]}},this.audioInitialized.bind(this),function(e){console.log("Error getting audio"),console.log(e)})}},{key:"audioInitialized",value:function(e){this.setState({recording:!0}),this.stream=e,this.audioChunks=[],this.mediaRecorder=new MediaRecorder(this.stream),this.mediaRecorder.start();var t=this.audioChunks;this.mediaRecorder.ondataavailable=function(e){t.push(e.data)},AudioContext=window.AudioContext||window.webkitAudioContext;var n=new AudioContext,o=null,i=null,r=null;this.rafID=null,this.analyserContext=null,this.canvasWidth=null,this.canvasHeight=null;r=n.createGain(),i=n.createMediaStreamSource(this.stream),o=i,o.connect(r),this.analyserNode=n.createAnalyser(),this.analyserNode.fftSize=2048,r.connect(this.analyserNode),this.zeroGain=n.createGain(),this.zeroGain.gain.value=0,r.connect(this.zeroGain),this.zeroGain.connect(n.destination);var s=this.updateAnalysers.bind(this);s()}},{key:"updateAnalysers",value:function(e){if(!this.analyserContext){var t=document.querySelector("canvas");this.canvasWidth=t.width,this.canvasHeight=t.height,this.analyserContext=t.getContext("2d")}var n=3,o=20,i=Math.round(this.canvasWidth/(n+o)),r=new Uint8Array(this.analyserNode.frequencyBinCount);this.analyserNode.getByteFrequencyData(r),this.analyserContext.clearRect(0,0,this.canvasWidth,this.canvasHeight),this.analyserContext.fillStyle="#F6D565",this.analyserContext.lineCap="round";for(var s=this.analyserNode.frequencyBinCount/i,a=0;i>a;++a){for(var l=0,u=Math.floor(a*s),c=0;s>c;c++)l+=r[u+c];l/=s,this.analyserContext.fillStyle="hsl( "+Math.round(90*a/i-50)+", 100%, 50%)",this.analyserContext.fillRect(a*(n+o),this.canvasHeight,o,-l)}this.state.recording&&(this.rafID=window.requestAnimationFrame(this.updateAnalysers.bind(this)))}},{key:"onRecordClick",value:function(){if(this.state.recording){this.setState({recording:!1}),this.mediaRecorder.stop();var e=new Blob(this.audioChunks,{type:"audio/ogg;"}),t=window.URL.createObjectURL(e);this.stream.getAudioTracks()[0].stop();var n,o=new FileReader,i=this;o.onload=function(){n=this.result;var e=i.drawWaveform.bind(i);e(n)},o.readAsArrayBuffer(e),this.setState({recordedAudioURL:t,recorded:!0})}else this.setState({recorded:!1}),this.initAudio()}},{key:"drawWaveform",value:function(e){var t=new Uint8Array(e),n=document.querySelector("canvas"),o=n.width,i=n.height,r=n.getContext("2d"),s=Math.ceil(t.length/o),a=i/2;r.fillStyle="#F77160",r.clearRect(0,0,o,i);for(var l=0;o>l;l++){for(var u=1,c=-1,d=0;s>d;d++){var p=(t[l*s+d]-127)/127;u>p&&(u=p),p>c&&(c=p)}r.fillRect(l,(1+u)*a,1,Math.max(1,(c-u)*a))}}},{key:"getButtonStyle",value:function(){return X["extends"]({},this.state.recording?Pe.stopButton:Pe.recButton)}},{key:"onPlayClick",value:function(){var e=document.querySelector("audio");e.play()}},{key:"onFocus",value:function(){this.props.onFocus()}},{key:"render",value:function(){return Be("div",{style:Pe.base},Be("div",{style:Pe.buttonAndSpectrum},Be("button",{style:this.getButtonStyle(),onFocus:this.onFocus.bind(this),onClick:this.onRecordClick.bind(this)},this.state.recording?"STOP":"REC"),Be("canvas",{style:Pe.spectrumAnalyzer,width:"1024",height:"80"}),this.state.recorded?Be("span",{onClick:this.onPlayClick.bind(this),style:Pe.playSymbol},"▶"):null),Be("audio",{src:this.state.recordedAudioURL}),this.state.recording?Be("h2",null,"Recording..."):null)}}]),t}(Te),Pe={base:{display:"block",color:"#888",padding:"20px 5%",width:"90%",border:"none",minHeight:"100px"},recButton:{width:"80px",height:"80px",background:"#C62828",color:"white",textAlign:"center",cursor:"pointer",borderRadius:"40px",transition:"all 1s",boxShadow:"0 7px 8px #CCC",flexShrink:"0",marginRight:"10px",border:"none",outline:"none"},stopButton:{width:"80px",height:"80px",background:"#37474F",color:"white",textAlign:"center",cursor:"pointer",borderRadius:"3px",transition:"all 1s",boxShadow:"0 7px 8px #CCC",flexShrink:"0",marginRight:"10px",border:"none",outline:"none"},spectrumAnalyzer:{background:"#f0f0f0",flexGrow:"1",width:"10%"},buttonAndSpectrum:{display:"flex",position:"relative"},playSymbol:{color:"white",background:"rgba(0,0,0,.2)",position:"absolute",top:"15px",right:"170px",fontSize:"35px",borderRadius:"40px",width:"50px",height:"50px",display:"block",border:"2px solid white",textAlign:"center",lineHeight:"46px",paddingLeft:"2px",cursor:"pointer"}},De=_e.h,Le=(_e.Component,function(e){function t(e,n){X.classCallCheck(this,t);var o=X.possibleConstructorReturn(this,Object.getPrototypeOf(t).call(this,e,n));return o.state={focused:!1,value:o.props.text||"",height:"100px"},o}return X.inherits(t,e),X.createClass(t,[{key:"onKeyDown",value:function(e){var t=Math.max(parseInt(e.target.style.height),e.target.scrollHeight-40);this.setState({value:e.target.value,height:t})}},{key:"onBlur",value:function(){this.state.value.length?this.setState({focused:!1,completed:!0,isValid:!0}):this.setState({focused:!1,completed:!1}),this.update()}},{key:"onFocus",value:function(){this.setState({focused:!0}),this.props.onFocus()}},{key:"getStyles",value:function(){return X["extends"]({},je.base,this.props.isValid?je.valid:je.error,this.state.focused?je.focused:{},{height:this.state.height})}},{key:"render",value:function(){return De("div",null,De("textarea",{style:this.getStyles(),placeholder:this.props.placeholder,defaultValue:this.state.value,onBlur:this.onBlur.bind(this),onFocus:this.onFocus.bind(this),onKeyDown:this.onKeyDown.bind(this),maxLength:this.props.maxLength?this.props.maxLength:"auto",ref:function(e){this.props.hasFocus&&e.focus()}.bind(this)}),this.props.maxLength?De("div",{style:je.remaining},this.props.maxLength-this.state.value.length," chars remaining."):null)}}]),t}(Re)),je={base:{display:"block",fontSize:"14pt",color:"black",padding:"0 0 10px 0",width:"100%",outline:"none",resize:"none",borderTop:"none",borderLeft:"none",borderRight:"none",borderBottom:"2px solid #999",transition:"border .5s"},focused:{borderBottom:"2px solid #009688"},remaining:{color:"#999",fontSize:"10pt",textAlign:"right",width:"100%",marginTop:"20px"}},He=_e.h,Ue=(_e.Component,function(e){function t(e,n){X.classCallCheck(this,t);var o=X.possibleConstructorReturn(this,Object.getPrototypeOf(t).call(this,e,n));return o.state=X["extends"](o.state,{value:o.props.text||""}),o}return X.inherits(t,e),X.createClass(t,[{key:"onKeyDown",value:function(e){switch(e.keyCode){case 13:this.validateAndSave({moveForward:!0});break;default:this.setState({value:e.target.value})}}},{key:"onChange",value:function(e){this.setState({value:e.target.value})}},{key:"validateAndSave",value:function(e){if(this.state.value.length?this.setState({focused:!1,completed:!0,isValid:!0}):this.setState({focused:!1,completed:!1}),this.props.validateAs)switch(this.props.validateAs){case"email":var t=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;this.setState({isValid:t.test(this.state.value)});break;case"url":}this.update(e)}},{key:"onBlur",value:function(){this.validateAndSave()}},{key:"onFocus",value:function(){this.setState({focused:!0}),this.props.onFocus()}},{key:"getStyles",value:function(){return X["extends"]({},Ve.base,this.props.isValid?Ve.valid:Ve.error,this.state.focused?Ve.focused:{})}},{key:"render",value:function(){return He("div",null,He("input",{type:"text",style:this.getStyles(),placeholder:this.props.placeholder,defaultValue:this.state.value,onFocus:this.onFocus.bind(this),onBlur:this.onBlur.bind(this),onChange:this.onChange.bind(this),onKeyDown:this.onKeyDown.bind(this),maxLength:this.props.maxLength?this.props.maxLength:"auto",ref:function(e){this.props.hasFocus&&e.focus()}.bind(this)}),this.props.maxLength?He("div",{style:Ve.remaining},this.props.maxLength-this.state.value.length," chars remaining."):null)}}]),t}(Re)),Ve={base:{display:"block",fontSize:"14pt",color:"black",padding:"0 0 10px 0",width:"100%",outline:"none",resize:"none",borderLeft:"none",borderRight:"none",borderTop:"none",borderBottom:"2px solid #999",transition:"border .5s"},focused:{borderBottom:"2px solid #009688"},remaining:{color:"#999",fontSize:"10pt",padding:"0px",textAlign:"right",width:"100%",marginTop:"5px"}},Ee=_e.h,We=_e.Component,qe=function(e){function t(e,n){X.classCallCheck(this,t);var o=X.possibleConstructorReturn(this,Object.getPrototypeOf(t).call(this,e,n));return o.state={text:o.props.text||""},o}return X.inherits(t,e),X.createClass(t,[{key:"render",value:function(){return Ee("header",{style:Ie.base},Ee("h1",{style:Ie.h1},this.props.text))}}]),t}(We),Ie={base:{display:"block",background:"#1565C0",padding:"40px 20px"},h1:{fontSize:"18pt",fontWeight:"600",color:"white"}},Ge=_e.h,Ke=_e.Component,Qe=function(e){function t(e,n){X.classCallCheck(this,t);var o=X.possibleConstructorReturn(this,Object.getPrototypeOf(t).call(this,e,n));return o.dragging=!1,o}return X.inherits(t,e),X.createClass(t,[{key:"componentDidMount",value:function(){this.ctx=this.canvas.getContext("2d"),this.ctx.strokeStyle="#F06A75",this.ctx.lineWidth=3,this.ctx.lineCap="round"}},{key:"onMouseDown",value:function(e){var t=e.clientX,n=e.clientY,o=this.canvas.getBoundingClientRect(),i=o.left,r=o.top;this.ctx.beginPath(),this.ctx.moveTo(t-i,n-r),this.dragging=!0}},{key:"onMouseUp",value:function(){this.dragging=!1}},{key:"onMouseMove",value:function(e){var t=e.clientX,n=e.clientY;if(this.dragging){var o=this.canvas.getBoundingClientRect(),i=o.left,r=o.top;this.draw(t-i,n-r)}}},{key:"draw",value:function(e,t){this.ctx.lineTo(e,t),this.ctx.stroke()}},{key:"onColorSelected",value:function(e){this.ctx.strokeStyle=e}},{key:"render",value:function(){var e=this,t=this.props,n=(t.width,t.height,t.onFocus);return Ge("div",{onClick:n},Ge("canvas",{width:"500",height:"300",ref:function(t){return e.canvas=t},onMouseDown:this.onMouseDown.bind(this),onMouseup:this.onMouseUp.bind(this),onMouseMove:this.onMouseMove.bind(this)}),Ge(Ye,{onColorSelected:this.onColorSelected.bind(this)}))}}]),t}(Ke),Ye=function(e){return Ge("div",null,["#F06A75","#DBE374","#A9EFA7","#4CE1E8","#2B80D3"].map(function(t){return Ge("div",{style:{display:"inline-block",backgroundColor:t,width:20,height:20,cursor:"pointer"},onClick:function(){return e.onColorSelected(t)}})}))},Ze=(_e.Component,_e.h),Xe=function(e){function t(e,n){X.classCallCheck(this,t);var o=X.possibleConstructorReturn(this,Object.getPrototypeOf(t).call(this,e,n));return o.state={rating:0,focused:-1,value:-1},o}return X.inherits(t,e),X.createClass(t,[{key:"getStyles",value:function(){return X["extends"]({},$e.base,this.props.isValid?$e.valid:$e.error)}},{key:"onBlur",value:function(){this.setState({focused:-1})}},{key:"onFocus",value:function(e,t){this.setState({focused:e}),this.props.onFocus()}},{key:"onHover",value:function(e,t){this.setState({focused:e}),t.target.focus(),this.props.onFocus()}},{key:"onClick",value:function(e,t){this.setState({focused:e,value:e}),this.state.value>=0?this.setState({completed:!0,isValid:!0}):this.setState({completed:!1}),this.update({moveForward:!0})}},{key:"onMouseOut",value:function(){this.setState({hovering:-1})}},{key:"onKeyDown",value:function(e){if(13!=e.keyCode){var t=this.state.focused;switch(e.keyCode){case 39:t=Math.min(this.props.steps-1,t+1);break;case 37:t=Math.max(0,t-1)}this.setState({focused:t})}}},{key:"getOptionStyle",value:function(e){return X["extends"]({},$e.option,e===this.state.value?$e.clicked:{},e===this.state.focused?$e.focused:{})}},{key:"getOptions",value:function(){for(var e=[],t=this.props.steps||5,n=0;t>n;n++)e.push(Ze("button",{onBlur:this.onBlur.bind(this),onFocus:this.onFocus.bind(this,n),onMouseOver:this.onHover.bind(this,n),onClick:this.onClick.bind(this,n),style:this.getOptionStyle(n),key:n,ref:function(e){this.props.hasFocus&&e.key===this.state.focused&&e.focus(),-1===this.state.focused&&this.props.hasFocus&&e.focus()}.bind(this)},Ze("img",{src:"http://lorempixel.com/100/150/?random"+n})));return e}},{key:"render",value:function(){return console.log("ImageOptions render"),Ze("div",{style:$e.base,onMouseOut:this.onMouseOut.bind(this),onKeyDown:this.onKeyDown.bind(this)},this.getOptions().map(function(e){return e}))}}]),t}(Re),$e={base:{display:"block",color:"#888",width:"90%",outline:"none",border:"none",minHeight:"100px"},option:{fontSize:"50px",cursor:"pointer",color:"#777",lineHeight:"50px",transition:"background .2s",background:"white",border:"1px solid #ccc",padding:"10px",outline:"none",margin:"0 10px 10px 0"},clicked:{background:"#F57C00"},focused:{background:"#FF5722"},focusedTitle:{color:"#009688"}},Je=Object.freeze({Rating:Ne,Audio:ze,TextArea:Le,TextField:Ue,Header:qe,Drawer:Qe,ImageOptions:Xe}),et=_e.h,tt=_e.Component,nt=function(e){function t(e,n){return X.classCallCheck(this,t),X.possibleConstructorReturn(this,Object.getPrototypeOf(t).call(this,e,n))}return X.inherits(t,e),X.createClass(t,[{key:"getStyles",value:function(){var e={};return"field"==this.props.type&&(e=X["extends"](e,this.props.hasFocus?ot.focused:ot.blurred,this.props.settings.showFieldNumbers?ot.withNumber:"")),X["extends"]({},ot.formFieldWrapper,e)}},{key:"getTitleStyles",value:function(){return X["extends"]({},ot.fieldTitle,this.props.hasFocus?ot.focusedTitle:{},this.state.completed&&!this.state.isValid?ot.invalidTitle:{})}},{key:"render",value:function(){var e=this.props;return et("div",{style:this.getStyles(),onClick:this.props.onClick.bind(this,this.props.index)},"field"==this.props.type&&this.props.settings.showFieldNumbers?et("span",{style:ot.fieldNumber},this.props.fieldNumber,"."):null,this.props.completed&&this.props.isValid?et("span",{style:ot.completedValid},"✔"):null,this.props.completed&&!this.props.isValid?et("span",{style:ot.completedInvalid},"✘"):null,"field"==this.props.type&&this.props.title?et("h3",{style:this.getTitleStyles()},this.props.title):null,et(Je[e.component],X["extends"]({},e.props,this.props)),this.props.completed&&!this.props.isValid?et("div",{style:ot.validation},this.props.validationMessage):null)}}]),t}(tt),ot={formFieldWrapper:{borderBottom:"1px solid #999",transition:"opacity .5s",position:"relative",background:"white"},withNumber:{padding:"15px 15px 15px 40px"},fieldNumber:{color:"#777",position:"absolute",top:"15px",left:"0px",width:"30px",textAlign:"right",fontSize:"14pt"},fieldTitle:{fontSize:"14pt"},completedValid:{color:"green",position:"absolute",top:"45px",left:"0px",width:"30px",textAlign:"right",fontSize:"16pt"},completedInvalid:{color:"#900",position:"absolute",top:"45px",left:"0px",width:"30px",textAlign:"right",fontSize:"16pt"},blurred:{opacity:.4},focused:{opacity:1},focusedTitle:{color:"#009688"},invalidTitle:{color:"#900"},validation:{color:"red",padding:"10px 0"}},it=_e.h,rt=_e.Component,st=function(e){function t(e,n){X.classCallCheck(this,t);var o=X.possibleConstructorReturn(this,Object.getPrototypeOf(t).call(this,e,n));return o.state=X["extends"]({currentStep:0,completedSteps:[],firstFocusable:-1,lastFocusable:-1},o.props),o.composerAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}(),o}return X.inherits(t,e),X.createClass(t,[{key:"componentDidMount",value:function(){this._composer.addEventListener("scroll",this.onScroll.bind(this))}},{key:"componentWillUnMount",value:function(){this._composer.addEventListener("scroll",this.onScroll.bind(this))}},{key:"onScroll",value:function(e){this._footer.style.bottom=-e.target.scrollTop+"px"}},{key:"onFocus",value:function(e){this.setState({currentStep:e})}},{key:"onSave",value:function(e){var t=X["extends"]({},this.state.page);t.children[e.index]=X["extends"]({},t.children[e.index],e);var n=e.moveForward?this.state.currentStep+1:this.state.currentStep;this.setState({page:t,currentStep:n})}},{key:"getFirstFocusable",value:function(){}},{key:"getLastFocusable",value:function(){}},{key:"nextStep",value:function(){this.setState({currentStep:this.state.currentStep+1})}},{key:"previousStep",value:function(){}},{key:"onKeyDown",value:function(e){var t=this.state.currentStep;switch(e.keyCode){case 40:t=Math.min(this.state.page.children.length,t+1);break;case 38:t=Math.max(0,t-1)}this.setState({currentStep:t})}},{key:"onClick",value:function(e){this.setState({currentStep:e})}},{key:"getQuestionBarStyles",value:function(e,t){var n=Math.ceil(e/t*100);return X["extends"]({},at.answeredQuestionsBarComplete,{
width:n+"%"})}},{key:"render",value:function(){var e=this,t=0,n=0;return it("div",{onKeyDown:this.onKeyDown.bind(this),ref:function(t){return e._composer=t},style:at.base},this.state.page.children.map(function(o,i){return"field"==o.type&&(t++,-1===e.state.firstFocusable&&(e.state.firstFocusable=i),e.state.lastFocusable=i),o.completed&&o.isValid&&n++,it(nt,X["extends"]({key:i,index:i,fieldNumber:t,hasFocus:e.state.currentStep==i,onFocus:e.onFocus.bind(e,i),onSave:e.onSave.bind(e),onClick:e.onClick.bind(e,i),settings:e.state.settings},o))}),it("div",{style:at.footer,ref:function(t){return e._footer=t}},it("div",{style:at.footerContent},it("div",{style:at.answeredQuestions},it("div",{style:at.answeredQuestionsBar},it("span",{style:this.getQuestionBarStyles(n,t)})),it("span",{style:at.answeredQuestionsText},n," of ",t," questions answered.")),it("div",{style:at.footerActions},it("button",{style:at.submit},"Send")))))}}]),t}(rt),at={base:{background:"#eee",position:"relative",paddingBottom:"150px",height:"700px",overflowY:"auto"},footer:{position:"absolute",bottom:"0",width:"100%",height:"70px",background:"#eee",borderTop:"1px solid #ccc"},footerContent:{padding:"15px",display:"flex"},answeredQuestions:{color:"#222",width:"400px",flexGrow:"1"},answeredQuestionsBar:{background:"#999",height:"15px",width:"100%",position:"relative",marginBottom:"5px",borderRadius:"3px"},answeredQuestionsBarComplete:{background:"linear-gradient(to left, #414d0b , #727a17)",height:"15px",position:"absolute",top:"0",left:"0",transition:"width .5s"},answeredQuestionsText:{fontSize:"10pt"},footerActions:{flexGrow:"1",textAlign:"right"},submit:{background:"#00897B",padding:"10px 40px",boxShadow:"0 2px 2px #555",borderRadius:"2px",border:"none",color:"white",textTransform:"uppercase",cursor:"pointer"}};e("* { font-family: 'Roboto', Helvetica, arial, sans-serif; }\n   \nhtml, body { \n	height: 100%;      \n	width: 100%;    \n	padding: 40px;\n	margin: 0;    \n	font-family: 'Roboto', Helvetica, arial, sans-serif;\n	font-weight: 400;\n	color: #444;\n	-webkit-font-smoothing: antialiased;\n	-moz-osx-font-smoothing: grayscale;\n\n  \n	background: #2c3e50; /* fallback for old browsers */\n	background: -webkit-linear-gradient(to left, #2c3e50 , #3498db); /* Chrome 10-25, Safari 5.1-6 */\n	background: linear-gradient(to left, #2c3e50 , #3498db); /* W3C, IE 10+/ Edge, Firefox 16+, Chrome 26+, Opera 12+, Safari 7+ */\n}\n\nh3 {\n	font-size: 11pt;\n	margin: 0 0 10px 0 ;\n	color: #999;\n}\n\n* {\n	box-sizing: border-box;\n}\n\n#app {\n	height: 100%;\n}\n");var lt=_e.h;_e.render(lt("div",null,lt(st,Z)),document.body)}();